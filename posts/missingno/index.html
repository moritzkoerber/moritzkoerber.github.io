<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="A plot says more than 1000 tables: Visualizing missing data with missingno" /><meta name="author" content="Moritz Körber" /><meta property="og:locale" content="en" /><meta name="description" content="A blog on various data science topics that I stumbled upon." /><meta property="og:description" content="A blog on various data science topics that I stumbled upon." /><link rel="canonical" href="https://moritzkoerber.github.io/posts/missingno/" /><meta property="og:url" content="https://moritzkoerber.github.io/posts/missingno/" /><meta property="og:site_name" content="Moritz Körber" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-08-02T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="A plot says more than 1000 tables: Visualizing missing data with missingno" /><meta name="twitter:site" content="@moritzkoerber" /><meta name="twitter:creator" content="@Moritz Körber" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Moritz Körber"},"dateModified":"2023-10-12T21:09:23+02:00","datePublished":"2019-08-02T00:00:00+02:00","description":"A blog on various data science topics that I stumbled upon.","headline":"A plot says more than 1000 tables: Visualizing missing data with missingno","mainEntityOfPage":{"@type":"WebPage","@id":"https://moritzkoerber.github.io/posts/missingno/"},"url":"https://moritzkoerber.github.io/posts/missingno/"}</script><title>A plot says more than 1000 tables: Visualizing missing data with missingno | Moritz Körber</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Moritz Körber"><meta name="application-name" content="Moritz Körber"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/resources/images/pic.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Moritz Körber</a></div><div class="site-subtitle font-italic">Data science and other board games</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVE</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/moritzkoerber" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/moritzkoerber" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://medium.com/@moritzkoerber" aria-label="medium" target="_blank" rel="noopener"> <i class="fab fa-medium"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['moritzjkoerber','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/moritzkoerber/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>A plot says more than 1000 tables: Visualizing missing data with missingno</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>A plot says more than 1000 tables: Visualizing missing data with missingno</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Moritz Körber </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 2, 2019, 12:00 AM +0200" >Aug 2, 2019<i class="unloaded">2019-08-02T00:00:00+02:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Oct 12, 2023, 9:09 PM +0200" >Oct 12, 2023<i class="unloaded">2023-10-12T21:09:23+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1886 words">10 min read</span></div></div><div class="post-content"><figure style="width: 33%; margin: 1.5rem auto 2rem;"> <img data-proofer-ignore data-src="/resources/images/2019-08-02-blogpost/black-and-white-black-and-white-challenge-262488.jpg" /></figure><p>Real-world data sets are very rarely free of missing values. Their causes are manifold: A participant could just have overlooked a survey item but it could also have been a controversial question where answers are refused by some. They could have been introduced completely at random, for example by logging errors, or systematically, for example because a condition was not met or a sensor was not recording.</p><p>Independent of their cause, there are two representations of missing values in Numpy/Pandas: <code class="language-plaintext highlighter-rouge">None</code> and <code class="language-plaintext highlighter-rouge">NaN</code>. <code class="language-plaintext highlighter-rouge">None</code> is the sentinel value implemented in arrays with dtype <code class="language-plaintext highlighter-rouge">object</code>, while <code class="language-plaintext highlighter-rouge">NaN</code> is a special floating-point value. Pandas was designed to handle both almost interchangeably.</p><p>Even if the machine learning application of your choice may digest data containing missing values, this simply means that they are ignored. Thus, no matter what you are doing, the decision whether to drop/ignore or to impute the missing values must be made. There are no fixed rules which method is better or even correct, both have advantages and disadvantages. It all comes down to the peculiarities of the data set at hand and to one’s understanding of this data set including its data generating process. But consensus is that the extent of missingness, its systematic, and interpretability are the key factors to a sensible decision in this case. Otherwise, you will either throw away a lot of information or introduce bias.</p><p>There is an extensive discussion of the various techniques for dealing with missing values in the literature, which is out of the scope of this blog post. In this post, I rather want to show how to approach a yet unseen data set and how to inspect the missing values with the package <a href="https://github.com/ResidentMario/missingno"><code class="language-plaintext highlighter-rouge">missingno</code></a><span style="font-size:12px;"><sup>1</sup></span>. A plot says more than 1000 tables, that’s why the package is so helpful here. It provides four ways to visually summarize the missing values, which give a great overview of the extent, patterns, and inter-relationship of missing data. Before this, I will begin with some preprocessing steps that bring the data in the right shape and make the analysis of missing values easier later.</p><p>The analyzed dataset contains listings of homestays in Boston, MA and Seattle, WA on <a href="https://www.airbnb.com">airbnb.com</a>. More details and a download link of the data set can be found <a href="https://www.kaggle.com/airbnb/boston">here</a> and <a href="https://www.kaggle.com/airbnb/seattle/data">here</a>.</p><p>Okay, let’s go!</p><h1 id="the-missingno-package">The missingno package</h1><p>First, let’s load the required packages.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1"># load packages
</span><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="n">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="c1"># some output options
</span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">pd</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">30</span>
</pre></table></code></div></div><p>Before this analysis, I did some preprocessing on the variable types and already merged the two data set into a single new data frame, <code class="language-plaintext highlighter-rouge">df</code>.</p><p>Before I check for missing data, I remove every feature that is certainly not related to the research question at hand and is of no predictive use anymore. For example, if you do not plan to join the data set with other data sets, you can safely remove identifiers such as <code class="language-plaintext highlighter-rouge">id</code>. You may find more variables that are not informative, but this is my selection of variables that can be definitely dropped for this blog post. In the end, it completely depends on your goal.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">listing_url</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">scrape_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">thumbnail_url</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">medium_url</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">picture_url</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">xl_picture_url</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">host_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">host_url</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">host_name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">host_about</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">host_thumbnail_url</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">host_picture_url</span><span class="sh">'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>Okay, let’s go check out the four plots of <code class="language-plaintext highlighter-rouge">missingno</code>.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># import missingno package
</span><span class="kn">import</span> <span class="n">missingno</span> <span class="k">as</span> <span class="n">msno</span>
</pre></table></code></div></div><h2 id="1-bar">1. bar()</h2><p><code class="language-plaintext highlighter-rouge">bar()</code> visualizes the nullity by column.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">msno</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2a028b1b7f0&gt;
</pre></table></code></div></div><figure style="width: 100%; margin: 1.5rem auto 2rem;"> <img data-proofer-ignore data-src="/resources/images/2019-08-02-blogpost/output_12_1.png" /></figure><p>That certainly looks confusing. Of course, a plot including all features makes sense to see what features are completely missing or completely present at first glance. But in all other cases, we first need to thin the data set before we proceed.</p><p>First, drop columns with no valid values:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">dropna</span><span class="p">(</span><span class="n">how</span> <span class="o">=</span> <span class="sh">'</span><span class="s">all</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>Drop any duplicate rows (just in case…):</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">()</span>
</pre></table></code></div></div><p>Next, remove constant features:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">VarianceThreshold</span>

<span class="n">nzv</span> <span class="o">=</span> <span class="nc">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span> <span class="c1"># only columns with more than 1% variance are retained
</span>
<span class="c1"># since the function digests only numericals and no NaNs, we need to select them
</span><span class="n">nums</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">number</span><span class="sh">'</span><span class="p">])).</span><span class="nf">dropna</span><span class="p">(</span><span class="n">how</span> <span class="o">=</span> <span class="sh">'</span><span class="s">any</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># apply the selector
</span><span class="n">nzv</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>

<span class="n">nums</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="o">~</span><span class="n">nzv</span><span class="p">.</span><span class="nf">get_support</span><span class="p">()]</span> <span class="c1"># excluded columns
</span></pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Index([], dtype='object')
</pre></table></code></div></div><p>No near zero variance columns are in the data set and, thus, no column will be removed in this step. Since we still have 76 columns, analyzing the missing data might be more insightful if we just look at the columns that in fact exhibit missing cases at some points (and it’s faster).</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># define date frame that contains only columns with at least one missing value
</span><span class="n">df_miss</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df</span><span class="p">.</span><span class="nf">isna</span><span class="p">().</span><span class="nf">any</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)]</span>
</pre></table></code></div></div><p>Tabulate proportion of NA per column. The output is again truncated to only include features with more than 2.5% missing values.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">truncate</span> <span class="o">=</span> <span class="n">df_miss</span><span class="p">.</span><span class="nf">isna</span><span class="p">().</span><span class="nf">mean</span><span class="p">()</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">025</span>
<span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">sum</span><span class="sh">'</span><span class="p">:</span> <span class="n">df_miss</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">truncate</span><span class="p">].</span><span class="nf">isna</span><span class="p">().</span><span class="nf">sum</span><span class="p">(),</span> <span class="sh">'</span><span class="s">mean</span><span class="sh">'</span><span class="p">:</span> <span class="n">df_miss</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">truncate</span><span class="p">].</span><span class="nf">isna</span><span class="p">().</span><span class="nf">mean</span><span class="p">()}).</span><span class="nf">round</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="sh">'</span><span class="s">mean</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>sum<th>mean<tbody><tr><th>square_feet<td>7250<td>0.979<tr><th>monthly_price<td>4998<td>0.675<tr><th>weekly_price<td>4502<td>0.608<tr><th>security_deposit<td>4195<td>0.567<tr><th>neighbourhood_group_cleansed<td>3585<td>0.484<tr><th>notes<td>3581<td>0.484<tr><th>neighborhood_overview<td>2447<td>0.331<tr><th>transit<td>2224<td>0.300<tr><th>cleaning_fee<td>2137<td>0.289<tr><th>space<td>1626<td>0.220<tr><th>review_scores_checkin<td>1478<td>0.200<tr><th>review_scores_location<td>1477<td>0.200<tr><th>review_scores_value<td>1477<td>0.200<tr><th>review_scores_accuracy<td>1481<td>0.200<tr><th>review_scores_cleanliness<td>1471<td>0.199<tr><th>review_scores_communication<td>1469<td>0.198<tr><th>review_scores_rating<td>1460<td>0.197<tr><th>reviews_per_month<td>1383<td>0.187<tr><th>last_review<td>1383<td>0.187<tr><th>first_review<td>1383<td>0.187<tr><th>host_acceptance_rate<td>1244<td>0.168<tr><th>host_response_rate<td>994<td>0.134<tr><th>host_response_time<td>994<td>0.134<tr><th>neighbourhood<td>959<td>0.130<tr><th>host_neighbourhood<td>639<td>0.086<tr><th>summary<td>320<td>0.043</table></div><p><code class="language-plaintext highlighter-rouge">square_feet</code> seems to be a rotten apple here. Does it hold the same information as <code class="language-plaintext highlighter-rouge">space</code>?</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="sh">'</span><span class="s">square_feet</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">space</span><span class="sh">'</span><span class="p">]].</span><span class="n">dtypes</span><span class="p">)</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>square_feet    float64
space           object
dtype: object
</pre></table></code></div></div><p>Nope, space is text!</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">space</span><span class="sh">'</span><span class="p">].</span><span class="nf">head</span><span class="p">()</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0    The house has an open and cozy feel at the sam...
1    Small but cozy and quite room with a full size...
2    Come stay with a friendly, middle-aged guy in ...
3    Most places you find in Boston are small howev...
4    Clean, attractive, private room, one block fro...
Name: space, dtype: object
</pre></table></code></div></div><p>Since <code class="language-plaintext highlighter-rouge">square_feet</code> is missing in 97.9 % of the cases, it adds no predictive value. Removing a feature that has almost no valid values is always rather safe because the potential for introducing bias is low and not much information is discarded.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">,</span> <span class="n">df_miss</span> <span class="o">=</span> <span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="sh">'</span><span class="s">square_feet</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="n">df</span><span class="p">,</span> <span class="n">df_miss</span><span class="p">])</span>
</pre></table></code></div></div><p>Plot again:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">msno</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">df_miss</span><span class="p">)</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2a02c0a79b0&gt;
</pre></table></code></div></div><figure style="width: 100%; margin: 1.5rem auto 2rem;"> <img data-proofer-ignore data-src="/resources/images/2019-08-02-blogpost/output_30_1.png" /></figure><p>Way better!</p><h2 id="2-matrix">2. matrix()</h2><p><code class="language-plaintext highlighter-rouge">matrix()</code> provides a nullity matrix to examine missing data by row. It is ideal to visually check whether the missing values follow any pattern. The spark line on the far right marks the most and least complete case.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">msno</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">df_miss</span><span class="p">)</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2a02c46abe0&gt;
</pre></table></code></div></div><figure style="width: 100%; margin: 1.5rem auto 2rem;"> <img data-proofer-ignore data-src="/resources/images/2019-08-02-blogpost/output_34_1.png" /></figure><p><code class="language-plaintext highlighter-rouge">sort = 'descending'</code> sorts the cases by their completeness.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">msno</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">df_miss</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="sh">'</span><span class="s">descending</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2a02f9fc320&gt;
</pre></table></code></div></div><figure style="width: 100%; margin: 1.5rem auto 2rem;"> <img data-proofer-ignore data-src="/resources/images/2019-08-02-blogpost/output_36_1.png" /></figure><h2 id="3-heatmap">3. heatmap()</h2><p>The <code class="language-plaintext highlighter-rouge">heatmap()</code> function visualizes how strongly the presence or absence of one variable does affect the presence of another. The visualized nullity correlation ranges from $-1$ (if one variable is present the other is certainly not present; marked in red) to $0$ (presence of one variable has no effect on the presence of the other) to $1$ (if one variable is present the other is certainly also present; marked in blue). Only the bottom half is presented because correlations are symmetric relations, i.e. the correlation between <em>A</em> and <em>B</em> is the same as between <em>B</em> and <em>A</em>. Variables with no missing values or no present values are removed from this visualization. Why? Because constant variables show no variance and, therefore, no matter what value another variable exhibits, there is also a present or always a missing value in the variable of question. There is also no diagonal because the correlation of a variable with itself does not make sense in this context.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">msno</span><span class="p">.</span><span class="nf">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2a02fb2c128&gt;
</pre></table></code></div></div><figure style="width: 100%; margin: 1.5rem auto 2rem;"> <img data-proofer-ignore data-src="/resources/images/2019-08-02-blogpost/output_39_1.png" /></figure><p>The default color scheme is <code class="language-plaintext highlighter-rouge">RdBu</code>, but you can pick another diverging color scheme by setting the <em>cmap</em> parameter (more info on the available color schemes can be found <a href="https://matplotlib.org/users/colormaps.html">here</a>).</p><p>How to read this plot? Let’s pick some numbers. The first $1$ shows up at the correlation between <code class="language-plaintext highlighter-rouge">host_response_time</code> and <code class="language-plaintext highlighter-rouge">host_response_rate</code>. Whenever an observation of <code class="language-plaintext highlighter-rouge">host_response_time</code> is present in a case, an observation of <code class="language-plaintext highlighter-rouge">host_response_rate</code> is also present (and vice versa). Values close to $1$ or $-1$ are marked by $&lt;1$/$&gt;-1$. These relationships deserve special attention because, for example, at $&lt;1$, an observation is almost always present in both variables, if it is present in any of the two variables, but in a few cases. For example, if there is an observation present in <code class="language-plaintext highlighter-rouge">first_review</code>, we would expect to see a corresponding observation in <code class="language-plaintext highlighter-rouge">last_review</code> as well, because this is almost everytime the case. If there is none, there might be a systematic mechanism at work, e. g., a certain condition is fulfilled which prevents data logging.</p><p>The function does not print correlations $-.05 &lt; r &lt; .05$, which is the case for the majority of correlations in the plot above. That means there is no linear relationship in the missingness between two variables. We can see that, for example, <code class="language-plaintext highlighter-rouge">cleaning_fee</code> exhibits a low to zero correlation to other variables. It seems that <code class="language-plaintext highlighter-rouge">cleaning_fee</code> is also missing if various other details on the accomodation are missing, but this is not necessarily true.</p><h2 id="4-dendrogram">4. dendrogram()</h2><p>Compared to the heatmap, the dendrogram zooms out a bit and helps to reveal clusters of missing datas. That is, not only pairwise relationships but also relationships between groups of variables. The function relies on a <a href="http://docs.scipy.org/doc/scipy/reference/cluster.hierarchy.html">hierarchical clustering algorithm</a> to cluster the features based on their missingness measured by binary distance (although other cluster methods can be set as well). The closer features are in this graph (i.e. the earlier their lines meet), the stronger is the link between their missingness.</p><p>Again, it makes sense to exclude variables that have no/only missing values. If the distance of a feature to these features is of interest, they may be included.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">msno</span><span class="p">.</span><span class="nf">dendrogram</span><span class="p">(</span><span class="n">df_miss</span><span class="p">)</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2a02fb2c860&gt;
</pre></table></code></div></div><figure style="width: 100%; margin: 1.5rem auto 2rem;"> <img data-proofer-ignore data-src="/resources/images/2019-08-02-blogpost/output_44_1.png" /></figure><p>As we can see, the variables that had a correlation of 1 in the plot above already meet at a distance of 0. We can see here that features regarding the review are strongly linked in their missingness – most of the time either all or none of these features are present. The same is true for some but not all host related feautures. If we examine cleaning_fee again, we see that it exhibits a large distance and, therefore, is weakly linked in it’s missingness just as we saw in the heatmap.</p><p>We now had a look at the missing values of the data set with the <code class="language-plaintext highlighter-rouge">missingno</code> package. I hope you enjoyed this intro and are now eager to make some plots for your own data set of choice.</p><p>Obtaining an understanding of the missingness in a data set is only one of many steps to be done before a valid model can be trained. I will go deeper into these preprocessing steps in future blog posts. Stay tuned!</p><p><br /> <br /></p><p>Github repo for this blogpost: <a href="https://github.com/moritzkoerber/visualize_w_missingno">https://github.com/moritzkoerber/visualize_w_missingno</a></p><p>Github repo for the missingno package: <a href="https://github.com/ResidentMario/missingno">https://github.com/ResidentMario/missingno</a></p><p><span style="font-size:12px;"><sup>1</sup></span> Bilogur, A. (2018). Missingno: a missing data visualization suite. <em>Journal of Open Source Software</em>, <em>3</em>(22), 547. <a href="https://doi.org/10.21105/joss.00547">https://doi.org/10.21105/joss.00547</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2" ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=A plot says more than 1000 tables: Visualizing missing data with missingno - Moritz Körber&url=https://moritzkoerber.github.io/posts/missingno/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4" ><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/duckdb-soda/"><div class="card-body"> <span class="timeago small" >Jun 15, 2023<i class="unloaded">2023-06-15T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Add data quality checks to your duckdb pipeline with Soda Core</h3><div class="text-muted small"><p> duckdb is a great and fast choice for pipelines running on a single instance and is an even better match if you’re pipeline oozes with SQL. To ensure that what you are doing with duckdb is actually...</p></div></div></a></div><div class="card"> <a href="/posts/de-exercises/"><div class="card-body"> <span class="timeago small" >Apr 8, 2022<i class="unloaded">2022-04-08T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Data Engineering Practice</h3><div class="text-muted small"><p> Yesterday, I finished the last exercise of Daniel Beach’s amazing data engineering exercises. The exercises look simple at first glance, but in each exercise I stumbled upon something of which I th...</p></div></div></a></div><div class="card"> <a href="/posts/deploy-with-oidc/"><div class="card-body"> <span class="timeago small" >Nov 28, 2021<i class="unloaded">2021-11-28T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Simple and secure deployment with Github Actions OpenID Connect (OIDC)</h3><div class="text-muted small"><p> Continuous delivery (CD) workflows implemented Github Actions help deploy software, create and update cloud infrastructure, or make use of various services of cloud providers like Amazon Web Servic...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/prediction-of-physical-exercise/" class="btn btn-outline-primary" prompt="Older"><p>Prediction of the quality of physical exercise on the basis of accelerometer data</p></a> <a href="/posts/preprocessing-in-pipeline/" class="btn btn-outline-primary" prompt="Newer"><p>How to apply preprocessing steps in a pipeline only to specific features</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//moritzkoerber-com.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'A plot says more than 1000 tables: Visualizing missing data with missingno'; this.page.url = 'https://moritzkoerber.github.io/posts/missingno/'; this.page.identifier = '/posts/missingno/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/moritzkoerber">Moritz Körber</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://moritzkoerber.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
